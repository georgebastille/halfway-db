You are an experinced python developer and data scientist. Your code styel is, in order, correctness, simplicity, elegance, and performance. Keeping the coee as simple as possible is more important than performance.

The task is to extend the output file shortest_paths.jsonl which currently contains data pulled from the tfl api and covers the tfl network. In the folder nationa_data are three files that contain data for stations and train jounrneys for the national UK network. The goal is then to extend this file with stations and times for the whole uk rail network.

The file was generated by constructing a graph of the tfl network and then using dijkstra's algorithm to find the shortest paths between all pairs of stations. The new code should do the same for the national rail network, and then merge the two graphs together. The final output should be a single file shortest_paths.jsonl that contains the shortest paths for both the tfl and national rail networks.

The structure of the graph is as follows:
Platforms are modelled as platofrm + line (for tfl, e.g. kings_cross-central. Stations where multiple lines meet have a hub node, and then time to get from a platofrm to the hub, and to the plarfotm of another line capture the time taken to change trains. For national rail, the same structure is used, but the line is the train operating company (e.g. kings_cross-lner). Each station also has a GROUND node, which links to the HUB. If a sation has only one platform, the GROUND links direclty to the platform. For national rail, there are slow trains (that stop at every station along the route) and express trains (that only stop at major stations). These are modelled as separate lines, e.g. lner-slow and lner-express. The time taken to change from a slow train to an express train is captured by the time taken to change from the platform of one line to the platform of another line via the HUB.

The shortest_path.jsonl file contains the time taken from each GROUND node to every other ground node.

The time taken to change between trains (captured in teh graph by the total time to move from one platform to the other should be based on the frequency of trains. Gegetting from the platofom to the hub is fixed (e.g. 2 min). getting from the hub to teh platform should be min(half the inter train time, 15 mins) for national rail.

The files are big, and the identifiers are not matching across files. I have found some patterns you should use:
tfl data:
HUBS have a cod like HUBKGX
CORPUS.json has a 3ALPHA code like KGX and a TIPLOC like KNGX
Stops.csv has a a field like 9100KNGX
toc_fill has a tiploc_code like KNGX

for non hubs
tfl has an id like 910GHONROPK
CORPUS.json has a TIPLOC like HONROPK
Stops.csv has an id like 9100HONROPK
toc_full has a tiploc_code like HONROPK

toc_full is massive and contains all timetables for each journey, including times from each stop to the next. It also contains the train operating company (toc_code) for each journey, which can be used to identify the line.

I would like you to also enrich the stations.jsonl file with a code, with the human readable name fo the staion and with the lat lon.
